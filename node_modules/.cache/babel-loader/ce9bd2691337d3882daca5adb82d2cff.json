{"ast":null,"code":"import _slicedToArray from\"/Users/kai-tenglo/Desktop/lighthouse/starting-project/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{IonAlert,IonBackButton,IonButton,IonButtons,IonContent,IonFab,IonFabButton,IonHeader,IonIcon,IonList,IonPage,IonTitle,IonToast,IonToolbar,isPlatform}from\"@ionic/react\";import{addOutline}from\"ionicons/icons\";import React,{useState,useRef,useContext}from\"react\";import{useParams}from\"react-router-dom\";import EditModal from\"../components/EditModal\";import EditableGoalItem from\"../components/EditableGoalItem\";import CoursesContext from\"../data/courses-context\";var CourseGoals=function CourseGoals(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),startedDeleting=_useState2[0],setStartedDeleting=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),toastMessage=_useState4[0],setToastMessage=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),isEditing=_useState6[0],setIsEditing=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),selectedGoal=_useState8[0],setSelectedGoal=_useState8[1];var slidingOptionsRef=useRef(null);var selectedGoalIdRef=useRef(null);var selectedCourseId=useParams().courseId;var coursesCtx=useContext(CoursesContext);var selectedCourse=coursesCtx.courses.find(function(c){return c.id===selectedCourseId;});var startDeleteHandler=function startDeleteHandler(goalId){setToastMessage(\"\");setStartedDeleting(true);selectedGoalIdRef.current=goalId;};var deleteGoalHandler=function deleteGoalHandler(){setStartedDeleting(false);coursesCtx.deleteGoal(selectedCourseId,selectedGoalIdRef.current);setToastMessage(\"Deleted Goal!\");};// startEditGoalHandler has an argument that is sent by onClick event in EditableGoalItem.tsx,\n// goalId was later prepended by the bind() operation as startEditGoalHandler 1st argument (always prepend using bind()).\n// Therefore, goalId is set as a parameter to startEditGoalHandler later on, no need to configure typescript in EditableGoalItem\nvar startEditGoalHandler=function startEditGoalHandler(goalId,event){var _slidingOptionsRef$cu;event.stopPropagation();var goal=selectedCourse===null||selectedCourse===void 0?void 0:selectedCourse.goals.find(function(g){return g.id===goalId;});(_slidingOptionsRef$cu=slidingOptionsRef.current)===null||_slidingOptionsRef$cu===void 0?void 0:_slidingOptionsRef$cu.closeOpened();if(!goal){return;}setIsEditing(true);setSelectedGoal(goal);};var startAddGoalHandler=function startAddGoalHandler(){setIsEditing(true);setSelectedGoal(null);};var cancelEditGoalHandler=function cancelEditGoalHandler(){setIsEditing(false);setSelectedGoal(null);};var saveGoalHandler=function saveGoalHandler(text){if(selectedGoal){coursesCtx.updateGoal(selectedCourseId,selectedGoal.id,text);}else{coursesCtx.addGoal(selectedCourseId,text);}setIsEditing(false);};var content=/*#__PURE__*/React.createElement(\"h2\",{className:\"ion-text-center\"},\"No goals found!\");if(!selectedCourse){content=/*#__PURE__*/React.createElement(\"h2\",{className:\"ion-text-center\"},\"No course found!\");}if(selectedCourse&&selectedCourse.goals.length>0){content=/*#__PURE__*/React.createElement(IonList,null,selectedCourse.goals.map(function(goal){return/*#__PURE__*/React.createElement(EditableGoalItem,{key:goal.id,slidingRef:slidingOptionsRef,text:goal.text,onStartDelete:startDeleteHandler.bind(null,goal.id),onStartEdit:startEditGoalHandler.bind(null,goal.id)});}));}return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(EditModal,{show:isEditing,onCancel:cancelEditGoalHandler,editedGoal:selectedGoal,onSave:saveGoalHandler}),/*#__PURE__*/React.createElement(IonToast,{isOpen:!!toastMessage,message:toastMessage,duration:2000}),/*#__PURE__*/React.createElement(IonAlert,{isOpen:startedDeleting,header:\"Are you sure?\",message:\"Do you want to delete the goal? This cannot be undone.\",buttons:[{text:\"No\",role:\"cancel\",handler:function handler(){setStartedDeleting(false);}},{text:\"Yes\",handler:deleteGoalHandler}]}),/*#__PURE__*/React.createElement(IonPage,null,/*#__PURE__*/React.createElement(IonHeader,null,/*#__PURE__*/React.createElement(IonToolbar,null,/*#__PURE__*/React.createElement(IonButtons,{slot:\"start\"},/*#__PURE__*/React.createElement(IonBackButton,{defaultHref:\"/courses/list\"})),/*#__PURE__*/React.createElement(IonTitle,null,selectedCourse?selectedCourse.title:\"No course found!\"),!isPlatform(\"android\")&&/*#__PURE__*/React.createElement(IonButtons,{slot:\"end\"},/*#__PURE__*/React.createElement(IonButton,{onClick:startAddGoalHandler},/*#__PURE__*/React.createElement(IonIcon,{slot:\"icon-only\",icon:addOutline}))))),/*#__PURE__*/React.createElement(IonContent,null,content,isPlatform(\"android\")&&/*#__PURE__*/React.createElement(IonFab,{horizontal:\"end\",vertical:\"bottom\",slot:\"fixed\"},/*#__PURE__*/React.createElement(IonFabButton,{color:\"secondary\",onClick:startAddGoalHandler},/*#__PURE__*/React.createElement(IonIcon,{icon:addOutline}))))));};export default CourseGoals;","map":{"version":3,"sources":["/Users/kai-tenglo/Desktop/lighthouse/starting-project/src/pages/CourseGoals.tsx"],"names":["IonAlert","IonBackButton","IonButton","IonButtons","IonContent","IonFab","IonFabButton","IonHeader","IonIcon","IonList","IonPage","IonTitle","IonToast","IonToolbar","isPlatform","addOutline","React","useState","useRef","useContext","useParams","EditModal","EditableGoalItem","CoursesContext","CourseGoals","startedDeleting","setStartedDeleting","toastMessage","setToastMessage","isEditing","setIsEditing","selectedGoal","setSelectedGoal","slidingOptionsRef","selectedGoalIdRef","selectedCourseId","courseId","coursesCtx","selectedCourse","courses","find","c","id","startDeleteHandler","goalId","current","deleteGoalHandler","deleteGoal","startEditGoalHandler","event","stopPropagation","goal","goals","g","closeOpened","startAddGoalHandler","cancelEditGoalHandler","saveGoalHandler","text","updateGoal","addGoal","content","length","map","bind","role","handler","title"],"mappings":"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","sourcesContent":["import {\n  IonAlert,\n  IonBackButton,\n  IonButton,\n  IonButtons,\n  IonContent,\n  IonFab,\n  IonFabButton,\n  IonHeader,\n  IonIcon,\n  IonList,\n  IonPage,\n  IonTitle,\n  IonToast,\n  IonToolbar,\n  isPlatform,\n} from \"@ionic/react\";\nimport { addOutline } from \"ionicons/icons\";\nimport React, { useState, useRef, useContext } from \"react\";\nimport { useParams } from \"react-router-dom\";\nimport EditModal from \"../components/EditModal\";\nimport EditableGoalItem from \"../components/EditableGoalItem\";\nimport CoursesContext from \"../data/courses-context\";\n\nconst CourseGoals: React.FC = () => {\n  const [startedDeleting, setStartedDeleting] = useState(false);\n  const [toastMessage, setToastMessage] = useState(\"\");\n  const [isEditing, setIsEditing] = useState(false);\n  const [selectedGoal, setSelectedGoal] = useState();\n\n  const slidingOptionsRef = useRef<HTMLIonItemSlidingElement>(null);\n  const selectedGoalIdRef = useRef<string | null>(null);\n\n  const selectedCourseId = useParams<{ courseId: string }>().courseId;\n\n  const coursesCtx = useContext(CoursesContext);\n\n  const selectedCourse = coursesCtx.courses.find(\n    (c) => c.id === selectedCourseId\n  );\n\n  const startDeleteHandler = (goalId: string) => {\n    setToastMessage(\"\");\n    setStartedDeleting(true);\n    selectedGoalIdRef.current = goalId;\n  };\n\n  const deleteGoalHandler = () => {\n    setStartedDeleting(false);\n    coursesCtx.deleteGoal(selectedCourseId, selectedGoalIdRef.current!);\n    setToastMessage(\"Deleted Goal!\");\n  };\n\n  // startEditGoalHandler has an argument that is sent by onClick event in EditableGoalItem.tsx,\n  // goalId was later prepended by the bind() operation as startEditGoalHandler 1st argument (always prepend using bind()).\n  // Therefore, goalId is set as a parameter to startEditGoalHandler later on, no need to configure typescript in EditableGoalItem\n  const startEditGoalHandler = (goalId: string, event: React.MouseEvent) => {\n    event.stopPropagation();\n    const goal = selectedCourse?.goals.find((g) => g.id === goalId);\n    slidingOptionsRef.current?.closeOpened();\n    if (!goal) {\n      return;\n    }\n    setIsEditing(true);\n    setSelectedGoal(goal);\n  };\n\n  const startAddGoalHandler = () => {\n    setIsEditing(true);\n    setSelectedGoal(null);\n  };\n\n  const cancelEditGoalHandler = () => {\n    setIsEditing(false);\n    setSelectedGoal(null);\n  };\n\n  const saveGoalHandler = (text: string) => {\n    if (selectedGoal) {\n      coursesCtx.updateGoal(selectedCourseId, selectedGoal.id, text);\n    } else {\n      coursesCtx.addGoal(selectedCourseId, text);\n    }\n    setIsEditing(false);\n  };\n\n  let content = <h2 className=\"ion-text-center\">No goals found!</h2>;\n\n  if (!selectedCourse) {\n    content = <h2 className=\"ion-text-center\">No course found!</h2>;\n  }\n\n  if (selectedCourse && selectedCourse.goals.length > 0) {\n    content = (\n      <IonList>\n        {selectedCourse.goals.map((goal) => (\n          <EditableGoalItem\n            key={goal.id}\n            slidingRef={slidingOptionsRef}\n            text={goal.text}\n            onStartDelete={startDeleteHandler.bind(null, goal.id)}\n            onStartEdit={startEditGoalHandler.bind(null, goal.id)}\n          />\n        ))}\n      </IonList>\n    );\n  }\n\n  return (\n    <React.Fragment>\n      <EditModal\n        show={isEditing}\n        onCancel={cancelEditGoalHandler}\n        editedGoal={selectedGoal}\n        onSave={saveGoalHandler}\n      />\n      <IonToast\n        isOpen={!!toastMessage}\n        message={toastMessage}\n        duration={2000}\n      />\n      <IonAlert\n        isOpen={startedDeleting}\n        header=\"Are you sure?\"\n        message=\"Do you want to delete the goal? This cannot be undone.\"\n        buttons={[\n          {\n            text: \"No\",\n            role: \"cancel\",\n            handler: () => {\n              setStartedDeleting(false);\n            },\n          },\n          {\n            text: \"Yes\",\n            handler: deleteGoalHandler,\n          },\n        ]}\n      />\n      <IonPage>\n        <IonHeader>\n          <IonToolbar>\n            <IonButtons slot=\"start\">\n              <IonBackButton defaultHref=\"/courses/list\" />\n            </IonButtons>\n            <IonTitle>\n              {selectedCourse ? selectedCourse.title : \"No course found!\"}\n            </IonTitle>\n            {!isPlatform(\"android\") && (\n              <IonButtons slot=\"end\">\n                <IonButton onClick={startAddGoalHandler}>\n                  <IonIcon slot=\"icon-only\" icon={addOutline} />\n                </IonButton>\n              </IonButtons>\n            )}\n          </IonToolbar>\n        </IonHeader>\n        <IonContent>\n          {content}\n          {isPlatform(\"android\") && (\n            <IonFab horizontal=\"end\" vertical=\"bottom\" slot=\"fixed\">\n              <IonFabButton color=\"secondary\" onClick={startAddGoalHandler}>\n                <IonIcon icon={addOutline} />\n              </IonFabButton>\n            </IonFab>\n          )}\n        </IonContent>\n      </IonPage>\n    </React.Fragment>\n  );\n};\n\nexport default CourseGoals;\n"]},"metadata":{},"sourceType":"module"}